<html>
  <body>
    <script>
      b = "Hello";
    </script>

    <script language="Python">
      import win32traceutil
      import sys
      print("Hello")
      a="Hi there"
      print("Location is", document.location)
      document.write("Hello", " from version ", 2, " of the Python AXScript Engine","<P>")
      document.writeln("This is Python", sys.version)
    </script>

    <p>
      The caption on the first button is set by the Window Load code. Clicking
      that button changes the text in the first edit box.
    </p>

    <p>The second button changes its own text when clicked.</p>

    <p>
      The fourth button calls a global function, defined in the global 'script'
      scope, rather than the 'MyForm' scope.
    </p>

    <form name="MyForm" method="GET">
      <script language="Python">
        print("Hello from in the form");
      </script>
      <input
        name="Button1"
        type="Button"
        OnClick="MyForm.Text1.value='Hi'"
        LANGUAGE="Python"
      />
      <input type="TEXT" size="25" name="Text1" />
      <input
        name="Button2"
        type="Button"
        value="Click for 'Hi'"
        OnClick="a='Howdy'; MyForm.Button2.value='Hi'"
        LANGUAGE="Python"
      />
      <input
        name="Button3"
        type="Button"
        value="Click for URL"
        OnClick="MyForm.Text2.value=document.location"
        LANGUAGE="Python"
      />
      <input type="TEXT" size="25" name="Text2" />
      <input
        name="Button4"
        type="Button"
        value="Call global fn"
        OnClick="foo1()"
        LANGUAGE="Python"
      />
      <input name="Button5" type="Button" value="Script for... Test" />
      <script for="Button5" event="onClick" language="Python">
        print("HelloThere")
        window.alert("Hello")
        def ATest():
        	print("Hello from ATEst")

        ATest()
      </script>
      <input
        name="Button6"
        type="Button"
        value="Set Other"
        OnClick="Form2.Text1.Value='Hi from other'"
        LANGUAGE="Python"
      />
    </form>
    <br />
    <p>And here is a second form</p>

    <p></p>
    <form name="Form2" method="GET">
      <input
        name="Button1"
        type="Button"
        OnClick="Form2.Text1.Value='Hi'"
        LANGUAGE="Python"
      />
      <input
        name="Button2"
        type="Button"
        value="Set Other"
        OnClick="MyForm.Text1.Value='Hi from other'"
        LANGUAGE="Python"
      />
      <input type="TEXT" size="25" name="Text1" />
      <input
        name="ButRExec"
        type="Button"
        value="RExec fail"
        OnClick="import win32api;win32api.MessageBox(0,'Oops')"
        LANGUAGE="Python"
      />
      <input
        name="ButRExec2"
        type="Button"
        value="RExec fail 2"
        OnClick="import sys,win32traceutil;print(sys.modules);from win32com.client import dynamic;import win32com.client.dynamic, pythoncom, win32com.client;o=win32com.client.Dispatch('Word.Application')"
        LANGUAGE="Python"
      />
      <input
        name="ButVB"
        type="Button"
        value="VBScript Button"
        OnClick='alert("Hi from VBScript")'
      />
      <input
        name="ButCallChain"
        type="Button"
        value="Multi-Language call"
        OnClick="CallPython()"
      />
    </form>
    <br />

    <script language="VBScript">
      function CallPython()
      	alert("Hello from VB - I'm about to call Python!")
      	PythonGlobalFunction()
      end function
    </script>

    <script language="JScript">
      function JScriptFunction() {
        alert("Hello from JScript");
      }
    </script>

    <script language="Python">
      x=13

      def foo1():
         y = 14
         for name, item in globals().items():
              print(name, "item")
         alert ("Hello from AXCode")
         print("Y is ", y)

      def PythonGlobalFunction():
      	window.alert("Hello from Python - I'm about to call JScript!")
      	window.JScriptFunction()

      def Window_OnLoad():
      	print("X is", x)
      	print("a is", a)
      #	print("------ GLOBALS ----------")
      #	for n,v in globals().items():
      #		print(n, '=', v)
      	print("MyForm is", MyForm)
      	print("MyForm is repr", "MyForm")
      	print("MyForm.Button1 is", "MyForm.Button1")
      	MyForm.Button1.Value = "Python Rules!"
      	Form2.Button1.value = "Form2!"
      	MyForm.Text1.value = document.location
    </script>
  </body>
</html>
